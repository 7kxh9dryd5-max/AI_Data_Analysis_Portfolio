# 🧪 Heracles NEO: AIを活用した科学研究データ解析パイプライン

## 1. プロジェクト概要：AI時代の科学解析

このプロジェクトは、複雑な多変量データ（化学物質ピーク強度など）を対象に、「誰でも再現可能」かつ「AIが判断根拠を説明できる」形で、グループ間の違いを多角的に解析し、最終的なレポートまでを自動生成する統合パイプラインです。

### 📌 開発の目的
1. **信頼性の確保：** 統計学（ANOVA）とAI（Random Forest）のハイブリッド採点により、主観に頼らない頑健な（ロバストな）重要特徴量を特定すること。
2. **AIの透明化（XAI）：** SHAP を用いて、AIモデルの判断根拠を解釈可能な形で可視化すること。
3. **再現性と自動化：** データ入力から最終レポート出力 までを全自動化し、解析の属人化を防ぐこと。

---

## 2. システムアーキテクチャとデータパイプライン

### A. 堅牢なデータ準備フェーズ
本パイプラインは、**3つの異なる入力ソース**を統合する高度な設計を採用しています。

1. **データ読み込み・クレンジング:** [セル2]
    * 汚れた生データ（`生データ.txt`）から、Moc様が設計した関数（`transform_column_name`）により、カラム名の自動整形とブランクサンプルの除去を実行します。
2. **多段的な外れ値処理:** [セル7, 8, 9]
    * **サンプル単位の除去（PCA基準）**、**ピーク単位の棄却検定（Z-score基準）**、**最終IQR基準** という3段階のクリーニングをグループごとに適用。
    * 欠損値は、安易なゼロ埋めではなく、**グループごとの中央値補完** という統計的に堅牢な手法で処理します。
3. **化学情報のマージ:** [セル5]
    * 外部の専門知識（`ピーク一覧/*.txt`）を自動で読み込み、データに「化学物質名」「官能的記述子」 を紐付けます。この情報がAIの解釈 の根拠となります。

---

## 3. 実装された分析アプローチと可視化手法

### A. 全体構造の可視化 (多変量解析)
| 手法 | 目的（なぜその手法を使うか） | 出力画像 |
| :--- | :--- | :--- |
| **PCA / PLS-DA / LDA** | グループ分離軸の特定とデータ全体の自然なばらつきの把握。 | `PCAプロット.png`, `PLS-DAプロット.png`, `LDAプロット.png` |
| **UMAP / t-SNE**| 複雑なデータの非線形構造を可視化し、隠れたクラスターがないか探索する。 | `UMAPプロット.png`, `t-SNEプロット.png` |
| **階層的クラスタリング** | サンプル間の系統樹（家系図）を作成し、グループの類似度関係を視覚化する。 | `階層的クラスタリング.png` |

### B. 補足分析とモデル解釈（重要度が高い部分）
| 分析項目 | 目的（なぜその分析が必要か） | 出力画像/ファイル |
| :--- | :--- | :--- |
| **相関ヒートマップ** | **統合ランク上位20ピーク**が互いに独立か、連動して変動する「仲間」 なのかを視覚的に調査する。 | `相関ヒートマップ.png` |
| **ボルケーノプロット** | 特定の2群間に絞り込み、「信頼性（p値）」と「変動の大きさ（Fold Change）」を同時検証する。 | `ボルケーノプロット_*.png` |
| **SHAPサマリー/ディシジョン** | AIの**判断根拠**を可視化。モデルが妥当な化学的特徴を重視しているかを裏付け。 | `SHAP_Summary_*.png`, `SHAP_Decision_*.png` |
| **バイオリンプロット** | AIが重要と判断したピークが、視覚的にも明確な差（分布の違い）を示しているかの最終検証。 | `最重要特徴量バイオリンプロット.png` |
| **モデル性能評価** | 交差検証（Cross-Validation） により、モデルの**真の予測性能**を推定する。 | `モデル性能評価.png` |

---

## 4. 最終成果物：自動生成レポートのハイライト

### A. AIによる統合考察 [セル26]
* **軸解釈:** PCAローディング のトップピークを自動で抽出し、その化学情報 に基づき「PC1軸は『A香』と『B香』の対比軸である」という文章を自動生成します。
* **グループプロファイル:** 各グループの均一性、他グループとの距離、AIが判断に用いたトップピーク を統合した「特徴プロファイル」を自動で書き下します。
* **納品物の証拠:** 解析に必要なPython、Pandas、SHAP等の**バージョン情報** をレポート末尾に自動記載することで、再現性を技術的に保証します。

### B. 特記事項 (Moc's Engineering)
* **デザイン統合:** Plotly とカスタムCSS を用いて、グラフの可視性、フォント、レイアウトの統一性を極限まで高めています。
* **堅牢性:** サンプル数に応じて交差検証の分割数 を自動調整したり、`output_dir` をタイムスタンプ でユニークにするなど、エラーや混同を防ぐための多数の安全装置 を実装しています。

---

## 5. 実行手順 (再現性の担保)

本リポジトリのコードは、誰でも再現可能です。

1.  本リポジトリをダウンロードします。
2.  `ポートフォリオ_AI解析.ipynb` をVS Codeなどで開きます。（データは内蔵のワインデータセットを使用）
3.  `セル0`（自動セットアップ）を実行し、すべてのセルを順に実行します。
4.  `セル28` が最終レポートをタイムスタンプ付きフォルダに自動生成します。

***
